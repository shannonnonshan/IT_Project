<!DOCTYPE html>
<html lang="en">
<html lang="en">

<head>
    <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Soundland</title>
    <link rel="icon" href="/static/imgs/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" 
    integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@100..900&display=swap" >
    {{{_sections.css}}}
</head>

<body>
    <div id="body-div" class="container-fluid">
        <div id="test" class="row no-gutters h-100">
            <div class="col-sm-2 p-0 h-100" style="background: linear-gradient(to bottom, #1A1C3D, #234B9C) !important;">
                <div id="nav-left">
                    {{#if auth}}
                    <div class="d-flex flex-column align-items-center" style="padding:0px;">
                        <form id="frmLogout" action="/account/logout" method="post"></form>
                        <a href="javascript: $('#frmLogout').submit()">
                            <i id="frmLogout" class="bi bi-arrow-left"></i>
                        </a>
                        
                        <div id="accountinf" class="d-flex align-items-center mt-3">
                            <img src="/static/imgs/avatar.jpg" alt="Profile Picture" class="img-fluid rounded-circle"
                                style="width: 50px; height: 50px; margin-right: 10px;">
                            <div id="account" class="text-left">
                                <h5 class="mb-0">{{authUser.username}}</h5>
                                <small id="fontaccount" class="text-muted">Logged in 6 days ago</small>
                            </div>
                        </div>
                    </div>
                    {{else}}
                       <div class="d-flex flex-row justify-between">
                            <a class="nav-link" href="/account/signup">
                                <i class=""></i>
                                Sign up
                            </a>
                            <a class="nav-link" href="/account/signin">
                                <i class=""></i>
                                Sign in
                            </a>
                       </div>
                       {{/if}}
                    <div class="card-body">
                        <ul class="nav flex-column">
                            <li class="nav-item"><a class="bi bi-exclude nav-link" href="#">Explore</a></li>
                            <li class="nav-item"><a class="bi bi-hearts nav-link" href="#">Love</a></li>
                            <li class="nav-item"><a class="bi bi-calendar-event nav-link" href="#">Events</a></li>
                            <h5>Music</h5>
                            <li class="nav-item"><a class="bi bi-file-earmark-music-fill nav-link" href="#">Songs</a>
                            </li>
                            <li class="nav-item"><a class="bi bi-people-fill nav-link" href="#">Artists</a></li>
                            <li class="nav-item"><a class="bi bi-vinyl nav-link" href="#">Albums</a></li>
                            <li class="nav-item"><a class="bi bi-cloud-arrow-up nav-link" href="#">Upload</a></li>
                            <h5>Your Playlists</h5>
                            <li class="nav-item"><a class="nav-link" href="#">Love</a></li>
                            <li class="nav-item"><a class="nav-link" href="#">Favorites</a></li>
                            <li class="nav-item"><a class="nav-link" href="#">Sad Music</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-sm-10 h-100">
                <div id="card-right" class="card h-100 ">
                    <div id="header-right" class="d-flex justify-content-between align-items-center">
                        <form id="searchform" class="input-group w-75">
                            <span class="bi bi-search input-group-text" id="basic-addon1"></span>
                            <input id="search-bar" type="text" class="form-control" placeholder="Search"
                                aria-label="Search" aria-describedby="basic-addon1">
                        </form>
                        <button type="button" class="btn btn-outline-warning">
                            <i class="bi bi-bell-fill"></i>
                            Read More
                        </button>
                        
                    </div>
                    <div class="card-body display-card">
                        {{{body}}}
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Music Player -->
        <div id="footer-music" class="d-flex flex-row align-items-center justify-content-between text-light">
            <div id="music-inf" class="d-flex flex-row align-items-center"> 
                <img src="static/imgs/images/apt nền.png" alt="Album Cover" class="album-cover me-3">
                <div class="title-music me-3">
                    <span class="font-weight-bold">APT</span><br>
                    <small class="fontaccount">Rosé, Bruno Mars</small>
                </div>
            </div>
            
            <div id="player-container">
                <div id="player" class="d-flex flex-column align-items-center justify-content-center">
                    <div id="audio-controls">
                        <button class="amplitude-prev">
                            <i class="bi bi-skip-start-fill component-player"></i>
                        </button>
                        <button class="amplitude-play-pause">
                            <i class="bi bi-play-circle-fill component-player"></i>
                        </button>
                        <button class="amplitude-next">
                            <i class=" bi bi-skip-end-fill component-player"></i>
                        </button>
                    </div>
                    <div id="progress-bar">
                        <span class="amplitude-current-time">00:00</span>
                        <input type="range" 
                                class="amplitude-song-slider" 
                                min="0" 
                                max="100" 
                                value="0"/>
                        <span class="amplitude-duration-time">00:00</span>
                    </div>
                </div>
            </div>

                {{!-- <audio src="/static/songs/1/main.mp3" type="audio/mp3" controls></audio> --}}
                {{!-- <button class="bi bi-skip-start-fill component-player"></button>
                <button class="bi bi-play-circle-fill component-player"></button>
                <button class="bi bi-skip-end-fill component-player"></button>
                <span class="time-info mx-2">1:43</span>
                <div id="progress-bar" class="progress mx-2" style="width: 200px; max-width:50vh">
                    <div class="progress-bar" style="width: 100%;"></div>
                </div>
                <span class="time-info mx-2">3:25</span>
                <button class="bi bi-volume-up-fill component-player"></button>
                <button class="bi bi-shuffle component-player"></button>
                <button class="bi bi-heart component-player"></button>
                <button class="bi bi-list component-player"></button> --}}
        </div>
    </div>

    <!-- Script dependencies -->
    <!-- Script dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.js"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"
        integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/amplitudejs@5.3.2/dist/amplitude.min.js"></script>
     {{{_sections.js}}}
    <!-- Link file custom -->
    <script src="/static/js/audio-player.js"></script>
    <script>
        // Lấy các phần tử
            // Lấy các phần tử
        console.log('Current Time:', Amplitude.getSongPlayedSeconds());
        console.log('Duration:', Amplitude.getSongDuration());
        const progressBar = document.querySelector('.amplitude-song-slider');

        // Hàm cập nhật giá trị của progress bar theo trạng thái bài hát
        function syncProgressBar() {
            const currentTime = Amplitude.getSongPlayedSeconds(); // Lấy thời gian hiện tại
            const duration = Amplitude.getSongDuration(); // Lấy tổng thời lượng bài hát

            // Cập nhật giá trị và giới hạn max của slider
            progressBar.max = duration;
            progressBar.value = currentTime;

            // Cập nhật màu gradient
            const percentage = (currentTime / duration) * 100;
            progressBar.style.background = `linear-gradient(to right, #1db954 ${percentage}%, #444 ${percentage}%)`;
        }

        // Gắn sự kiện 'timeupdate' từ Amplitude.js
        Amplitude.bind('timeupdate', syncProgressBar);

        // Gắn sự kiện 'input' để người dùng kéo thanh tay
        progressBar.addEventListener('input', function () {
            const seekTime = progressBar.value; // Giá trị mà người dùng kéo đến
            Amplitude.setSongPlayedSeconds(seekTime); // Cập nhật thời gian phát
        });
    </script>
</body>
</html>
